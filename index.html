<!DOCTYPE html>
<html
  lang="en"
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:th="https://www.thymeleaf.org"
  class="background"
>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Agrotep</title>
    <link
      rel="shortcut icon"
      type="image/png"
      href="assets/images/logos/favicon.png"
    />
    <link rel="stylesheet" href="assets/css/styles.min.css" />
    <link rel="stylesheet" href="assets/css/settingStyle.css" />
    <link rel="stylesheet" href="map.css" />
    <script defer src="assets/libs/jquery/dist/jquery.min.js"></script>
    <script src="assets/libs/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script defer src="/assets/js/sidebarmenu.js"></script>
    <script defer src="/assets/js/app.min.js"></script>
    <script defer th:src="@{/assets/libs/simplebar/dist/simplebar.js}"></script>
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script
      defer
      th:src="@{/assets/libs/select2-4.1.0-rc.0/dist/js/select2.min.js}"
    ></script>
    <script
      defer="defer"
      th:src="@{/assets/js/update-transportation-details.js}"
    ></script>
    <script defer="defer" th:inline="javascript">
      /*<![CDATA[*/
      const loadingTypes = /*[[${loadingTypes}]]*/ null;
      const unloadingTypes = /*[[${unloadingTypes}]]*/ null;
      const loadingTypesMap = /*[[${loadingTypesMap}]]*/ null;
      /*]]>*/
    </script>
    <style>
      #map {
        height: 100vh;
        z-index: 1;
      }
      .small-text {
        font-size: 12px;
        color: gray;
        margin-left: 10px;
      }
      .leaflet-popup-content {
        width: 400px !important;
      }
      .bd-wrapper {
        margin-left: 270px;
      }
      .logo-img-small {
        display: none;
      }
      .side-wd {
        width: 270px !important;
      }
      .side-hide {
        display: block !important;
      }

      @media (max-width: 2850px) {
        .bd-wrapper {
          margin-left: 100px;
        }
        .left-sidebar {
          width: 100px;
          border-right: 1px solid #ddd;
        }
        .hide-menu {
          display: none;
        }
        .logo-img {
          display: none;
        }
        .logo-img-small {
          display: block;
        }
        .logo-img-small img {
          width: 55px;
        }
      }

      @media (max-width: 1200px) {
        .bd-wrapper {
          margin-left: 10px;
        }
        .left-sidebar {
          width: 270px;
          border-right: 1px solid #ddd;
        }
        .hide-menu {
          display: block;
        }
        .logo-img {
          display: block;
        }
        .logo-img-small {
          display: none;
        }
      }
      @media (min-width: 900px) {
        tbody,
        thead {
          text-wrap: nowrap;
        }
      }
      @media (min-width: 1200px) {
        .header {
          width: calc(100% - 100px) !important;
        }
        @media (min-width: 2850px) {
          .bd-wrapper {
            margin-left: 270px;
          }
          .header {
            width: calc(100% - 270px) !important;
          }
        }
      }
      @media (max-width: 1363px) {
      }
      @media (max-width: 1066px) {
      }
      @media (max-width: 1066px) {
      }
      @media (max-width: 500px) {
      }
      @media (max-width: 450px) {
        .dropdown-menu-my {
          right: auto !important;
          top: 20px !important;
          left: -280px !important;
        }
      }
    </style>
  </head>

  <body>
    <!--  Body Wrapper -->
    <div
      class="page-wrapper"
      id="main-wrapper"
      data-layout="vertical"
      data-navbarbg="skin6"
      data-sidebartype="full"
      data-sidebar-position="fixed"
      data-header-position="fixed"
    >
      <!-- Sidebar Start -->
      <aside class="left-sidebar background">
        <!-- Sidebar scroll-->
        <div>
          <div
            class="brand-logo d-flex align-items-center justify-content-between"
          >
            <div class="text-nowrap logo-img">
              <img src="assets/images/logos/dark-logo.png" width="180" alt="" />
            </div>
            <div class="text-nowrap logo-img-small">
              <img
                src="assets/images/logos/favicon.png"
                id="togl-side-btn"
                width="180"
                alt="icon"
                style="cursor: pointer"
              />
            </div>

            <div
              class="close-btn d-xl-none d-block sidebartoggler cursor-pointer"
              id="sidebarCollapse"
            >
              <i class="ti ti-x fs-8"></i>
            </div>
          </div>
          <!-- Sidebar navigation-->
          <div
            class="container d-flex flex-column align-items-center fs-2 ms-1"
            style="margin-top: -10px; width: max-content"
          >
            <div class="display-time fw-bold"></div>
            <div class="display-date fw-bold">
              <span id="daynum">00</span>.<span id="month">00</span>.<span
                id="year"
                >0000</span
              >
            </div>
          </div>
          <nav class="sidebar-nav scroll-sidebar" data-simplebar="">
            <ul id="sidebarnav">
              <li class="nav-small-cap">
                <i class="ti ti-dots nav-small-cap-icon fs-4"></i>
                <span class="hide-menu">Логістика</span>
              </li>
              <li class="sidebar-item">
                <a
                  class="sidebar-link"
                  href="./import-export.html"
                  aria-expanded="false"
                >
                  <span>
                    <i class="ti ti-layout-dashboard"></i>
                  </span>
                  <span class="hide-menu">Імпорт-експорт</span>
                </a>
              </li>
              <li class="sidebar-item">
                <a
                  class="sidebar-link"
                  href="./notebook.html"
                  aria-expanded="false"
                >
                  <span>
                    <i class="ti ti-notebook"></i>
                  </span>
                  <span class="hide-menu">Зошит</span>
                </a>
              </li>
              <li class="sidebar-item">
                <a
                  class="sidebar-link"
                  href="./manager.html"
                  aria-expanded="false"
                >
                  <span>
                    <i class="ti ti-list-check"></i>
                  </span>
                  <span class="hide-menu">Зошит</span>
                </a>
              </li>
              <li class="sidebar-item">
                <a
                  class="sidebar-link"
                  href="./planer.html"
                  aria-expanded="false"
                  style="position: relative"
                >
                  <span>
                    <i class="ti ti-clipboard"></i>
                  </span>
                  <span class="hide-menu">Планер</span>
                  <span
                    style="
                      position: absolute;
                      font-weight: bold;
                      right: 15px;
                      bottom: -0px;
                      background-color: red;
                      color: white;
                      border-radius: 40px;
                      display: flex;
                      justify-content: center;
                      align-items: center;
                      width: 20px;
                      height: 20px;
                      font-size: 12px;
                    "
                    >2</span
                  >
                </a>
              </li>
              <li class="sidebar-item">
                <a
                  class="sidebar-link"
                  href="./manager.html"
                  aria-expanded="false"
                >
                  <span>
                    <i class="ti ti-map"></i>
                  </span>
                  <span class="hide-menu">Карта</span>
                </a>
              </li>
            </ul>
          </nav>
          <!-- End Sidebar navigation -->
        </div>
        <!-- End Sidebar scroll-->
      </aside>
      <!--  Sidebar End -->
      <!--  Main wrapper -->
      <div class="bd-wrapper">
        <!--  Header Start -->
        <header class="app-header header background">
          <nav class="navbar navbar-expand-lg navbar-light">
            <ul class="navbar-nav">
              <li class="nav-item d-block d-xl-none">
                <a
                  class="nav-link sidebartoggler nav-icon-hover"
                  id="headerCollapse"
                  href="javascript:void(0)"
                >
                  <i class="ti ti-menu-2"></i>
                </a>
              </li>
            </ul>

            <div
              class="navbar-collapse justify-content-end px-0"
              style="flex-basis: auto"
              id="navbarNav"
            >
              <ul
                class="navbar-nav flex-row ms-auto align-items-center justify-content-end"
              >
                <li class="nav-item dropdown">
                  <a
                    class="nav-link nav-icon-hover"
                    href="javascript:void(0)"
                    id="drop2"
                    data-bs-toggle="dropdown"
                    aria-expanded="false"
                  >
                    <img
                      src="assets/images/profile/user-1.jpg"
                      alt=""
                      width="35"
                      height="35"
                      class="rounded-circle"
                    />
                  </a>
                  <div
                    class="dropdown-menu dropdown-menu-end dropdown-menu-animate-up"
                    aria-labelledby="drop2"
                  >
                    <div class="message-body">
                      <!-- <a class="d-flex align-items-center gap-2 dropdown-item">
                        <i class="ti ti-user fs-6"></i>
                        <p class="mb-0 fs-3">Мій Профіль</p>
                      </a> -->
                      <span
                        class="d-flex align-items-center gap-2 dropdown-item cursor-pointer data-bs-targe"
                        data-bs-toggle="modal"
                        data-bs-target="#telegramBotModal"
                      >
                        <i class="ti ti-brand-telegram fs-6 text-primary"></i>
                        <span class="mb-0 fs-3">Telegram_bot</span>
                      </span>
                      <a
                        href="javascript:void(0)"
                        class="d-flex align-items-center gap-2 dropdown-item"
                        data-bs-toggle="modal"
                        data-bs-target="#settingsModal"
                      >
                        <i class="ti ti-settings fs-6"></i>
                        <p class="mb-0 fs-3">Мої Налаштування</p>
                      </a>
                      <form th:action="@{/logout}" method="post">
                        <input
                          class="btn btn-outline-primary mx-3 mt-2 d-block"
                          type="submit"
                          value="Вийти з системи"
                        />
                      </form>
                    </div>
                  </div>
                </li>
              </ul>
            </div>
          </nav>
        </header>
        <div id="map"></div>

        <!-- Шаблон попапа -->
        <div id="popup-template" style="display: none">
          <div class="container p-2" style="width: 400px">
            <h5 class="text-center" id="popup-coordinates"></h5>
            <ul id="item-list" class="list-group mb-2">
              <li class="list-group-item d-flex flex-column gap-1">
                <div class="d-flex justify-content-between align-items-center">
                  <input
                    type="text"
                    class="form-control me-2"
                    value="Элемент 1"
                  />
                  <button class="btn btn-danger btn-sm">
                    <svg
                      width="20"
                      height="21"
                      viewBox="0 0 20 21"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path
                        d="M6 5.14239L6 3.4709C6 2.30611 6 1.72371 6.34942 1.36186C6.69883 1 7.26121 1 8.38596 1L11.614 1C12.7388 1 13.3012 1 13.6506 1.36186C14 1.72371 14 2.30611 14 3.4709V5.14239"
                        stroke="white"
                        stroke-width="2"
                      />
                      <path
                        d="M12 10.2152V15.2152"
                        stroke="white"
                        stroke-width="2"
                        stroke-linecap="round"
                      />
                      <path
                        d="M8 10.2152V15.2152"
                        stroke="white"
                        stroke-width="2"
                        stroke-linecap="round"
                      />
                      <path
                        d="M16.1145 14.5237C15.9656 15.8716 15.861 16.8079 15.7072 17.525C15.5572 18.2237 15.3796 18.6123 15.1451 18.8991C14.9486 19.1395 14.7159 19.3478 14.4555 19.5168C14.1447 19.7184 13.7389 19.8523 13.0279 19.9246C12.2983 19.9988 11.3562 20 10.0001 20C8.64393 20 7.70181 19.9988 6.97221 19.9246C6.26123 19.8523 5.85545 19.7184 5.54464 19.5168C5.2842 19.3478 5.05155 19.1395 4.85503 18.8991C4.62049 18.6123 4.44288 18.2237 4.29297 17.525C4.13912 16.8079 4.0345 15.8716 3.88562 14.5237L2.88129 5.43042L17.1188 5.43042L16.1145 14.5237Z"
                        stroke="white"
                        stroke-width="2"
                      />
                      <path
                        d="M1 5.12195H19"
                        stroke="white"
                        stroke-width="2"
                        stroke-linecap="round"
                      />
                    </svg>
                  </button>
                </div>
                <span class="small-text"
                  >Дата: <span class="date"></span> | Автор: Белих. Я.</span
                >
              </li>
            </ul>
            <button class="btn btn-primary w-100 mb-2" onclick="addItem()">
              Додати елемент
            </button>
            <button class="btn btn-success w-100">Зберегти</button>
          </div>
        </div>
      </div>
    </div>
    <!-- Тичасова ф-ція на час демонстрації -->
    <script>
      const btnsRemove = document.querySelectorAll(".remove-driver");
      btnsRemove.forEach((item) => {
        const name = item
          .closest(".accordion-item")
          .querySelector(".driver-name").textContent;
        const number = item
          .closest(".accordion-item")
          .querySelector(".driver-number").textContent;
        item.addEventListener("click", () => {
          if (confirm(`Ви дійсно бажаєте видалити екіпаж ${name} ${number}?`)) {
            item.closest(".accordion-item").remove();
          }
        });
      });
    </script>

    <script src="manager.js"></script>
    <script src="assets/js/settingsStyle.js"></script>
    <script>
      var popoverTriggerList = [].slice.call(
        document.querySelectorAll('[data-bs-toggle="popover"]')
      );
      var popoverList = popoverTriggerList.map(function (popoverTriggerEl) {
        return new bootstrap.Popover(popoverTriggerEl);
      });
    </script>
    <script>
      var cardBodies = document.querySelectorAll(".card-body-col");

      cardBodies.forEach(function (body) {
        var parentCol = body.closest(".card-col");
        var childrenCount = body.children.length;

        if (childrenCount < 10 && parentCol) {
          parentCol.style.breakInside = "avoid";
        }
      });
    </script>
    <script>
      function checkDropdownPosition(element) {
        let dropdownMenu = element.nextElementSibling;
        let rect = dropdownMenu.getBoundingClientRect();
        console.log(rect, window.innerHeight);
        if (rect.right > window.innerWidth) {
          dropdownMenu.style.cssText = `left: -${
            rect.right - window.innerWidth
          }px !important; top:20px;`;
        }
      }
    </script>
    <script src="https://unpkg.com/imask"></script>
    <script>
      const element = document.getElementById("telegramPhone");
      const maskOptions = {
        mask: "+{38\\0} (00) 000-00-00",
        lazy: false,
      };
      const mask = new IMask(element, maskOptions);
    </script>

    <script src="clock.js"></script>
    <!-- Скрипт попапа -->
    <script>
      const capitals = [
        { name: "Австрія", lat: 48.2082, lng: 16.3738 },
        { name: "Албанія", lat: 41.3275, lng: 19.8189 },
        { name: "Андорра", lat: 42.5078, lng: 1.5211 },
        { name: "Бельгія", lat: 50.8503, lng: 4.3517 },
        { name: "Болгарія", lat: 42.6975, lng: 23.3242 },
        { name: "Боснія і Герцеговина", lat: 43.8563, lng: 18.4131 },
        { name: "Ватикан", lat: 41.9029, lng: 12.4534 },
        { name: "Велика Британія", lat: 51.5074, lng: -0.1278 },
        { name: "Угорщина", lat: 47.4979, lng: 19.0402 },
        { name: "Німеччина", lat: 52.52, lng: 13.405 },
        { name: "Греція", lat: 37.9838, lng: 23.7275 },
        { name: "Данія", lat: 55.6761, lng: 12.5683 },
        { name: "Ірландія", lat: 53.3498, lng: -6.2603 },
        { name: "Ісландія", lat: 64.1355, lng: -21.8954 },
        { name: "Іспанія", lat: 40.4168, lng: -3.7038 },
        { name: "Італія", lat: 41.9028, lng: 12.4964 },
        { name: "Косово", lat: 42.6629, lng: 21.1655 },
        { name: "Латвія", lat: 56.9496, lng: 24.1052 },
        { name: "Литва", lat: 54.6872, lng: 25.2797 },
        { name: "Ліхтенштейн", lat: 47.1416, lng: 9.5215 },
        { name: "Люксембург", lat: 49.6117, lng: 6.1319 },
        { name: "Мальта", lat: 35.8997, lng: 14.5146 },
        { name: "Молдова", lat: 47.0105, lng: 28.8638 },
        { name: "Монако", lat: 43.7384, lng: 7.4246 },
        { name: "Нідерланди", lat: 52.3676, lng: 4.9041 },
        { name: "Норвегія", lat: 59.9139, lng: 10.7522 },
        { name: "Польща", lat: 52.2298, lng: 21.0122 },
        { name: "Португалія", lat: 38.7169, lng: -9.1399 },
        { name: "Румунія", lat: 44.4268, lng: 26.1025 },
        { name: "Сан-Марино", lat: 43.9333, lng: 12.45 },
        { name: "Північна Македонія", lat: 41.9981, lng: 21.4254 },
        { name: "Сербія", lat: 44.7866, lng: 20.4489 },
        { name: "Словаччина", lat: 48.1486, lng: 17.1077 },
        { name: "Словенія", lat: 46.0511, lng: 14.5051 },
        { name: "Україна", lat: 50.4501, lng: 30.5234 },
        { name: "Фінляндія", lat: 60.1695, lng: 24.9354 },
        { name: "Франція", lat: 48.8566, lng: 2.3522 },
        { name: "Хорватія", lat: 45.815, lng: 15.9819 },
        { name: "Чорногорія", lat: 42.4304, lng: 19.2594 },
        { name: "Чехія", lat: 50.0755, lng: 14.4378 },
        { name: "Швейцарія", lat: 46.9481, lng: 7.4474 },
        { name: "Швеція", lat: 59.3293, lng: 18.0686 },
        { name: "Естонія", lat: 59.437, lng: 24.7536 },
      ];

      const map = L.map("map").setView([50, 10], 4);
      L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
        attribution: "&copy; OpenStreetMap contributors",
      }).addTo(map);

      capitals.forEach((capital) => {
        const marker = L.marker([capital.lat, capital.lng]).addTo(map);
        marker.on("click", function (e) {
          const popupContent = document
            .getElementById("popup-template")
            .cloneNode(true);
          popupContent.style.display = "block";
          popupContent.querySelector("#popup-coordinates").textContent =
            capital.name;

          L.popup().setLatLng(e.latlng).setContent(popupContent).openOn(map);
        });
      });

      function addItem() {
        const itemList = document.querySelector("#item-list");
        if (!itemList) return;

        const newItem = document.createElement("li");
        newItem.className = "list-group-item d-flex flex-column";
        newItem.innerHTML = `
          <div class="d-flex justify-content-between align-items-center">
            <input type="text" class="form-control me-2" value="Новий елемент" />
            <button class="btn btn-danger btn-sm">
              <svg width="20" height="21" viewBox="0 0 20 21" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M6 5.14239L6 3.4709C6 2.30611 6 1.72371 6.34942 1.36186C6.69883 1 7.26121 1 8.38596 1L11.614 1C12.7388 1 13.3012 1 13.6506 1.36186C14 1.72371 14 2.30611 14 3.4709V5.14239" stroke="white" stroke-width="2"/>
<path d="M12 10.2152V15.2152" stroke="white" stroke-width="2" stroke-linecap="round"/>
<path d="M8 10.2152V15.2152" stroke="white" stroke-width="2" stroke-linecap="round"/>
<path d="M16.1145 14.5237C15.9656 15.8716 15.861 16.8079 15.7072 17.525C15.5572 18.2237 15.3796 18.6123 15.1451 18.8991C14.9486 19.1395 14.7159 19.3478 14.4555 19.5168C14.1447 19.7184 13.7389 19.8523 13.0279 19.9246C12.2983 19.9988 11.3562 20 10.0001 20C8.64393 20 7.70181 19.9988 6.97221 19.9246C6.26123 19.8523 5.85545 19.7184 5.54464 19.5168C5.2842 19.3478 5.05155 19.1395 4.85503 18.8991C4.62049 18.6123 4.44288 18.2237 4.29297 17.525C4.13912 16.8079 4.0345 15.8716 3.88562 14.5237L2.88129 5.43042L17.1188 5.43042L16.1145 14.5237Z" stroke="white" stroke-width="2"/>
<path d="M1 5.12195H19" stroke="white" stroke-width="2" stroke-linecap="round"/>
</svg>
</button>
          </div>
          <span class="small-text">Дата: ${new Date().toLocaleDateString()} | Автор: Белих. Я.</span>
        `;

        itemList.appendChild(newItem);
      }
    </script>
  </body>
</html>
